# Вводная 
**SQL** ([аббр.](https://ru.wikipedia.org/wiki/%D0%90%D0%B1%D0%B1%D1%80%D0%B5%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0 "Аббревиатура") от [англ.](https://ru.wikipedia.org/wiki/%D0%90%D0%BD%D0%B3%D0%BB%D0%B8%D0%B9%D1%81%D0%BA%D0%B8%D0%B9_%D1%8F%D0%B7%D1%8B%D0%BA "Английский язык") **S**tructured **Q**uery **L**anguage — «язык структурированных запросов») — [декларативный](https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D0%BA%D0%BB%D0%B0%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5 "Декларативное программирование") [язык программирования](https://ru.wikipedia.org/wiki/%D0%AF%D0%B7%D1%8B%D0%BA_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F "Язык программирования"), применяемый для создания, модификации и управления данными в [реляционной базе данных](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%BB%D1%8F%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5_%D0%B1%D0%B0%D0%B7%D1%8B_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Реляционные базы данных"), управляемой соответствующей [системой управления базами данных](https://ru.wikipedia.org/wiki/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F_%D0%B1%D0%B0%D0%B7%D0%B0%D0%BC%D0%B8_%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85 "Система управления базами данных").

## Типы SQL
SQL делится на 4 типа:

DDL - Data Definition Language — это группа команд, которые используются для создания и изменения структуры объектов базы данных: таблиц, представлений, схем и индексов. Наиболее известные команды SQL DDL — CREATE, ALTER, DROP. 

DML - Data Manipulation Language — это группа операторов, которые позволяют получать и изменять записи, присутствующие в таблице.

DCL - Data Control Language — это команды SQL, которые используют для предоставления и отзыва привилегий пользователя базы данных. При этом пользователь не может откатить изменения. GRANT и REVOKE.

TCL - Transaction Control Language — одни из наиболее популярных команд SQL. Их используют для обеспечения согласованности базы данных и для управления транзакциями.

#Транзакция — это набор SQL-запросов, выполняемых над данными, которые объединены в атомарную секцию. Это значит, что промежуточные результаты операции не видны для других конкурирующих транзакций — и вся секция будет либо выполнена, либо полностью отменена в случае ошибки.

Примеры команд: BEGIN/COMMIT, ROLLBACK.

В MS SQL используется диалект SQL - T-SQL.

## Общая инфа
Адрес хранения БД
![[Pasted image 20240102215637.png]]

Показывать номера строк
![[Pasted image 20240102222603.png]]

-- - однострочный комментарий
/* многострочный комментарий* /

declare @Test bit = 0 - объявить переменную Тест с типом bit со значением 0

print @somebit - вывести переменную

set @somebit = 123 - переопределить значение для переменной @somebit

declare @decimalExample decimal(8,5) = 123.5612 - объявить  переменную с типом decimal. Первый аргумент - число состоит из 8 символов. Второй - 5 символов после запятой.

## Формат данных
MS-SQL при проектировании БД позволяет выбирать разный формат хранения данных. Принципиальное отличие varchar от nvarchar в формате хранения символов - кодировке.
varchar - ASCII (1 символ - 1 бит), разработан для англоязычных символов;
nvarchar - Unicode (1 символ - 2 бита), разработан практически для всех знаков мира. Используются различные форматы UTF-8, 16, 32 и т.д.

### Даты
Создаются с помощью функций или через строковые данные с помощью кавычек.
declare @somedate date = '01-17-2017' - задать через строку
set @somedate = '20170117' - привести отображение даты к универсальному формату

declare @somedateTime datetime = '17-01-2017 03:36:49'

print @somedateTime

### Строковые данные

Если данные фиксированной длины (например номера телефонов) - то переменная типа nchar.
Если переменной длины - то nvarchar

### Арифметические операторы

Сложение +
Вычитание -
Умножение *
Деление /
Остаток деления % - select 7%5

declare @x int = 123, @y int = 124
select @x + @y

У каждого арифметического оператора имеется свой приоритет вычисления. 

### Заполнить таблицу вручную
![[Pasted image 20240414214529.png]]

## Linked Server MS SQL

[https://info-comp.ru/what-is-linked-server](https://info-comp.ru/what-is-linked-server)

Linked Server – объект в MS SQL при помощи которого мы можем делать выгрузку с внешнего источника данных (другая БД, ИС, файлы и т.д.) в нужную нам БД. Пишется условно процедура в которой указывается адрес внешнего источника.

При этом каждый раз в SQL запросах указывать данные для подключения к источнику не требуется, как в случае с OPENDATASOURCE и OPENROWSET, так как связанный сервер хранит все настройки подключения, которые были указаны в процессе создания связанного сервера.