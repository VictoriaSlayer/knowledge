[[БД от ВК 1. Введение]]
# Основы реляционной модели
Реляционная модель данных - логическая модель данных, прикладная теория построения баз данных, которая является приложением к задачам обработки данных таких разделов математики, как теория множеств и логика первого порядка

Отношение - представление множества в теории множеств. В реляционной модели отношение - это множество связанных между собой данных, которые в базе данных реализуются в виде таблицы.
В логике авторов отношением можно считать таблицу.

Отношение состоит из заголовка (схемы) и тела. Заголовок представляет собой множество атрибутов, а тело множество кортежей, соответствующих заголовку.
Кортеж - строка.
В отношении нет двух одинаковых элементов.
Порядок кортежей в отношении не определен.
Порядок атрибутов (столбцов) также не определен.

Наше представление данных в виде таблиц по факту лишь удобный GUI для восприятия информации. Поэтому мы и пользуемся терминами таблица, столбец и т.д. в которых есть null значения. По факту в реляционной модели нет null значений и информация там оформлена не в виде таблицы, а в виде отношений и кучи всего там также нет.

# Нормализации БД
Нормализация - процесс преобразования отношений БД к виду, отвечающему нормальным формам.

## Цели нормализации
Нормальная форма - свойство отношения в реляционной модели данных, характеризующее его с точки зрения избыточности, потенциально приводящей к логически ошибочным результатам выборки или изменения данных. Нормальная форма - совокупность требований, которым должно удовлетворять отношение.


Исключение избыточного дублирования данных;
Устранение некоторых аномалий добавления, обновления, удаления кортежей;
Упрощение контроля целостности данных;
Проектирование БД, которая более понятно описывает реальный мир и готова к дальнейшему расширению;

# Нормальные формы
Их много, но будут рассмотрены только 3:
## Первая нормальная форма (1NF)
Если есть повторяющиеся строки, то это не 1NF.

Каждый кортеж отношения содержит единственное значение соответствующего типа (домена) в позиции любого атрибута - или проще говоря, в табличном представлении отношении, на пересечении любой строки и любого столбца мы видим только одно значение.

Домен - подтип данных более узкоспециализированный тип данных, который удовлетворяет определенному условию.

Не редки ситуации, когда в одной ячейке хранится не одно значение необходимое для соответствующего домена, т.к. домен слишком широкий по своему смыслу.
![[Pasted image 20240728190626.png]]
В этом хорошей практикой будет считаться выделить данные по Customer в отдельные более подробные атрибута - адрес, телефон, мобильный телефон.
![[Pasted image 20240728190826.png]]
Проблематика здесь возникает в переменном количестве столбцов по продуктам. Мы зависим от того сколько людей какое количество продуктов купят.

![[Pasted image 20240728191737.png]]
Выше мы привели таблицу к нормальной форме - на пересечении столбца и строки хранится только одно значение. Единственная проблема - таблица слишком разрослась и было бы неплохо все эти данные поделить.
Для домена также выделяют атомарность, но понятие атомарности не включается в первую нормальную форму.
Принципы нормализации - формализованный здравый смысл (Кристофер Дейт).

## Вторая нормальная форма (2NF)
Каждая следующая нормальная форма подразумевает, что для ее реализации необходимо чтобы требования предыдущей формы выполнены.

2NF избавляет нас от избыточности дублирования данных. В таблице не должно быть не ключевых столбцов, которые функционально не зависят от всего первичного ключа.
Если у вас не составной первичный ключ, переходите к третьей нормальной форме.
![[Pasted image 20240728193800.png]]
Целый набор столбцов не зависит от ключевых столбцов.
Информация по Customer зависит от Customer. Информация по продуктам также зависит от него. Вряд ли отдельные позиции в заказе будет нести другой курьер.

Разнесли информацию по разным таблицам
![[Pasted image 20240728194115.png]]
Теперь в каждой таблице каждый не ключевой столбец зависит от всего ключа.
## Третья нормальная форма (3NF)
Не один не ключевой атрибут (столбец) не должен находиться в транзитивной функциональной зависимости от потенциального ключа.
Транзитивная зависимость возникает тогда, когда не ключевой атрибут зависит от первичного ключа не напрямую, а транзитивно - т.е. через другой не ключевой атрибут.
![[Pasted image 20240728194950.png]]
Помимо зависимости от составного ключа у нас транзитивная зависимость от столбца продукт.

![[Pasted image 20240728195746.png]]
Транзитивная зависимость - зарплата зависит от должности, а не от человека.

![[Pasted image 20240728195648.png]]
Выше мы избавились от транзитивной зависимости. 

Денормализация - откат на форму ниже. 