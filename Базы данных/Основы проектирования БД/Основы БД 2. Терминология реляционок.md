[[БД от ВК 1. Введение]]
[[TSQL-6. Целостность данных, первичный и внешний ключ.]]
# Введение
Если человек владеет только молотком, то ему все кажется гвоздями.
Если человек владеет только реляционными БД, то попытка впихнуть в реляционную БД иерархические данные приведет к тому, что обработка информации будет весьма долгая.
Прежде чем тратить время на оптимизацию реляционной БД убедитесь, что она вам действительно нужна. Иногда проект лучше начинать с нереляционной БД потому что она будет быстрее и с меньшим количеством кода.

# Взгляд на Реляционки
Есть несколько точек зрения на работу реляционнок. Условно можно разделить на формальный и неформальный подходы.
## Неформально
Неформально БД выглядит как набор столбцов и строк.
#Представление - результат запроса.
### Домен
#Домен - набор значений допустимых для ввода в столбец, которые подходят туда по смыслу и назначению. Домен тесно связан с типом данных, но это не одно и то же. 
Условно для столбца *Адрес* у нас тип данных строковые значения. Мы можем туда ввести любое строковое значение например Красный. Но должны вводить только значения по смыслу относящиеся к адресам.
### Отношения, атрибуты, кортежи
#### Отношения
Отношение многофункциональный термин.
Отношение - связь между несколькими таблицами.
Отношение - значения столбцов в одной строке.
#### Атрибут
Атрибут - столбец, элемент данных.
#### Кортеж
Кортеж - строка. Множества пар {атрибут, значение}, которое содержит одно вхождение каждого имени атрибута, принадлежащего схеме отношения.
### Ключи
В самом широком смысле:
##### Теоретические термины
#Ключ - комбинация одного или нескольких столбцов, которая используется для поиска строк в таблице.
*Составной ключ* - ключ включающий в себя значения более чем одного поля.
**Суперключ** - набор одного или нескольких столбцов таблицы, для которого ни одна из двух строк не может иметь одинаковые значения.
*Потенциальный ключ* - минимальный суперключ. Если удалить столбец, то перестает таковым быть. 
От себя - довольно тонкая грань логики между суперключом и потенциальным. Страница 80 объяснение.
Ключи могут быть естественными (природные) и искусственными (сгенерированный UID).
Ключи к БД желательно делать единообразными.
##### Практические термины
*Уникальный ключ* - суперключ использующийся для однозначной идентификации строки в таблице. Может быть несколько на всю таблицу.
В TSQL - Unique.

*Первичный ключ* - уникальный ключ использующийся для быстрого поиска записей в таблице. ВСЕГДА Один на всю таблицу. 
В TSQL - Primary key. Выбирается на свое усмотрение.

*Внешний ключ* - используется для принудительного установления связи между данными двух таблиц.
В TSQL - Foreign key.
##### Прочее
*Альтернативный ключ* - потенциальный ключ, не являющийся первичным ключом.
Если у нас несколько потенциальных ключей, то один из них выбирается в качестве первичного, другие в качестве альтернативного.
*Вторичный ключ* - ключ не гарантирующий уникальности.
#### По ключам
У разных ключей разное предназначение. В одной таблице может быть как Primary, так и Foreign Key и использоваться они будут для разных целей:
- primary для идентификации уникальных объектов в рамках таблицы;
- foreign для допустимых значений из другой таблицы, чтобы сохранить целостность данных

По хорошему любой ключ должен исчезать вместе с записью, если эту запись стирают. А не переприсваиваться новой записи.
Не стоит использовать в качестве значений ключи, которые вы не контролируете (например производитель переприсвоил артикул со всеми вытекающими).
### Индексы
Индекс - структура БД тесно связанная с ключами и позволяющая находить необходимые строки быстрее.
### Ограничения
Все ограничения из TSQL-6.