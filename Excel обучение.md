Формула в умной таблице
=СУММ(Имя_умной_таблицы[Имя_столбца])

# Условное форматирование
[ссылка на ролик](https://www.youtube.com/watch?v=bhMyd7xKJuM&list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&index=17)
Инструмент дает довольно большие возможности для визуального отображения данных. В частности для поиска повторяющихся и уникальных значений.

Также там можно задать правила для форматирования выделив конкретный массив

![[Pasted image 20231129071718.png|400]]

Мы можем использовать условное форматирование при помощи формул
### Условное форматирование через формулы
[ссылка](https://www.youtube.com/watch?v=bhMyd7xKJuM&list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&index=12)
Через меню Создать правило мы можем создать правило для определенных ячеек, если они соответствуют условию. Условия завязаны на абсолютные и относительные ссылки, можно использовать формулы.
При этом, если мы меняем значение ячейки с которой сравниваем, форматирование сравниваемых ячеек меняется.

Например разукрасить все ячейки зеленым, которые больше ячейки М4
![[Pasted image 20231129074024.png|300]]

Раскрасить ячейки в диапазоне между 30 и 50

![[Pasted image 20231129075231.png|400]]

#### Типы Ссылок
Относительные F4
Абсолютные $F$4
Смешанные F$4

Сделать абсолютной/смешанной ссылку можно при помощи команды F4

#### Формулы
В формулах эксель можно проворачивать интересный трюк - когда в формуле выбираем диапазон из одной ячейки. Например - =СУММ(G26:G26) или =СУММ(G26:$G$26).
##### СУММЕСЛИ
=суммесли(диапазон; условие; диапазон_суммирования);
1 аргумент - массив среди которого сортируем;
2 аргумент - условие по которому фильтруем ИСТИНА;
3 аргумент - массив по которому складываем, длина этого массива должна быть равна дли не 1-го аргумента;
##### СУММЕСЛИМН 
Если необходимо больше одного условия, то подойдет формула СУММЕСЛИМН, там до 127 условий можно сделать:
=суммеслиМН(диапазон_суммирования; диапазон_условия1; условие1; диапазон_условия2; условие2;  диапазон_условия3;  условие3...);
Таким образом мы суммируем данные по 1-му массиву через фильтрацию массива 1-го и 2-го условий, если там есть заданные аргументы. При этом длинны всех массивов должны совпадать.

excel_выпадающий_список
![[Pasted image 20231202210828.png|500]]

##### Текстовые функции
[ссылка](https://www.youtube.com/watch?v=K-HEEqoz3PM)
Конкатенация бывает 3 типов, как со словами, так и с числами:
Левсимв извлечение первых левых символов из строки
Правсимв извлечение первых правых символов из строки
ПСТР извлечение из середины слова
Сделать буквы ПРОПИСНЫМИ, строчными, узнать длину строки, удалить лишние пробелы.

Математические формулы
- суммеслимн - СУММЕСЛИМН(Отчет[Продажи];Отчет[Месяц];[@Месяц];Отчет[Регион];$C$2;Отчет[Категория магазина];$C$3)
В данном случае Отчет[Месяц] - название умной таблицы и столбец на которые ссылаемся
- счётеслимн - =СЧЁТЕСЛИМН(Отчет[Месяц];[@Месяц];Отчет[Регион];$C$2;Отчет[Категория магазина];$C$3)
- срзначеслимн - СРЗНАЧЕСЛИМН(Отчет[Продажи];Отчет[Месяц];[@Месяц];Отчет[Регион];$C$2;Отчет[Категория магазина];$C$3)

СУММПРОИЗВ
[ссылка](https://www.youtube.com/watch?v=Do2hvui5T0k&list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&index=18)
Возвращает суммупроизведений массивов. Есть пару интересных фокусов связанных с приведением типов данных, которые стоит использовать, т.к. в какой-то степени облегчает работу.

#### Сводные таблицы
[ссылка](https://www.youtube.com/watch?v=vgMe8f6Itwo)
[поменять формат отображения данных в ячейке](https://youtu.be/vgMe8f6Itwo?list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&t=576)
![[Pasted image 20231203094357.png]]

Убрать автоматическое расширение столбцов при обновлении данных в таблице:
пкм по сводной таблице -> автоматически изменять ширину столбцов при обновлении

Выбрать первые 10 значений
![[Pasted image 20231203100749.png|500]]

Выбрать первые несколько значений
![[Pasted image 20231203105729.png]]

Мы можем делать сортировку различных столбцов от убывания/увеличения при помощи фильтра сортировка:
![[Pasted image 20231203105033.png]]

Также мы можем делать сортировку по категории внутри категории. Мы выбираем значение и там фильтруем.
![[Pasted image 20231203105431.png]]

##### Срезы
Для созданных таблиц мы можем создать Срез - это фильтр который находится вне сводной таблицы. 
![[Pasted image 20231203105917.png]]
Созданный срез можно подключить к нескольким отчетам, чтобы сделать его более динамичным.
![[Pasted image 20231203110021.png]]
#### Умные таблицы
[ссылка](https://www.youtube.com/watch?v=vmpK4F8OYlo)
В умную таблицу можно добавить строку итогов через Конструктор Таблиц. Там можно выбрать метрику, по которой отсеивать отклонения.
Размер таблицы можно изменять через правый уголок внизу.
Умная таблица это объект и имя ей задается через вкладку Конструктор Таблиц.
Преимущество умной таблицы в том, что она динамическая и данные оттуда автоматически попадают в графики и сводные таблицы.
[формулы в умной таблице](https://youtu.be/vmpK4F8OYlo?list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&t=860)

#### Логические функции
Все логические функции можно посмотреть в закладке Формулы - логические функции.
Функция И: =И(B5>C5; B5>D5);
Функция ИЛИ: =ИЛИ(B5>C5; B5>D5);

Текстовые значения в формулах всегда пишутся в двойных кавычках.
##### Функция_Если
Если(Условие; Если условие истинно то - Результат1; Если условие ложно то - Результат2);

##### Даты
[Основы](https://www.youtube.com/watch?v=tV19TrqMHQ0&list=PLeuq3F0vVbzBv1Gg5Zku0sUigBqKRai54&index=20&ab_channel=%D0%91%D0%B0%D1%80%D1%85%D0%B0%D1%82%D0%BE%D0%B2%D0%92%D0%B8%D1%82%D0%B0%D0%BB%D0%B8%D0%B9%28EXCEL%2CVBA%2CPowerBI%29)
Приведение даты к числу.
КОпируем пустую ячейку, копируем нужный нам диапазон, делаем специальную вставку, выбираем сложение. Эксель делает приведение числа к дате и форматирует все даты к числам. [Подробнее в ролике](https://www.youtube.com/watch?v=lVge1TwvyyI&ab_channel=%D0%A3%D0%BD%D0%B8%D0%B2%D0%B5%D1%80%D1%81%D0%B8%D1%82%D0%B5%D1%82%D0%90%D0%BB%D0%B5%D0%BA%D1%81%D0%B5%D1%8F%D0%9F%D0%BE%D0%BB%D1%8F%D0%BD%D1%81%D0%BA%D0%BE%D0%B3%D0%BE)