![[Pasted image 20250309224518.png]]
![[Pasted image 20250309224525.png]]
# Безопасный метод
Метод HTTP является **безопасным**, если он не меняет состояние сервера. Другими словами, безопасный метод проводит операции "только чтение" (read-only). Несколько следующих методов HTTP безопасные: [`GET`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/GET), [`HEAD`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/HEAD) или [`OPTIONS`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/OPTIONS). Все безопасные методы являются также [идемпотентными](https://developer.mozilla.org/ru/docs/Glossary/Idempotent), как и некоторые другие, но при этом небезопасные, такие как [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT) или [`DELETE`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/DELETE).
Даже если безопасные методы являются по существу "только для чтения", сервер всё равно может сменить своё состояние: например, он может сохранять статистику. Что существенно, так то, когда клиент вызывает безопасный метод, то он не запрашивает никаких изменений на сервере, и поэтому не создаёт дополнительную нагрузку на сервер.
# Идемпотентный метод
Метод HTTP является идемпотентным, если повторный идентичный запрос, сделанный один или несколько раз подряд, имеет один и тот же эффект, не изменяющий состояние сервера. Другими словами, идемпотентный метод не должен иметь никаких побочных эффектов (side-effects), кроме сбора статистики или подобных операций. Корректно реализованные методы [`GET`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/GET), [`HEAD`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/HEAD), [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT) и [`DELETE`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/DELETE) **идемпотентны**, но не метод [`POST`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/POST). Также все [безопасные](https://developer.mozilla.org/ru/docs/Glossary/Safe) методы являются идемпотентными.
## Примеры идемпотентных методов
### Get
`GET /pageX HTTP/1.1` идемпотентен. Вызвавший несколько раз подряд этот запрос, клиент получит тот же результат:
GET /pageX HTTP/1.1
GET /pageX HTTP/1.1
### Post
`POST /add_row HTTP/1.1` не идемпотентен; если его вызвать несколько раз, то он добавит несколько строк:
POST /add_row HTTP/1.1
POST /add_row HTTP/1.1   -> Adds a 2nd row
POST /add_row HTTP/1.1   -> Adds a 3rd row
### Delete
`DELETE /idX/delete HTTP/1.1` идемпотентен, даже если возвращаемый код отличается:

DELETE /idX/delete HTTP/1.1   -> Returns 200 if idX exists
DELETE /idX/delete HTTP/1.1   -> Returns 404 as it just got deleted
DELETE /idX/delete HTTP/1.1   -> Returns 404

# Cacheable methods
-Cacheable methods - поддаются кешированию. Большая часть идемпотентных методов кешируется хорошо, неидемпотентные - кешируются тяжело. [Get; Head; Options; Post; Patch]

# Описание методов
## Head
HEAD - проверяет состояние ресурса и ничего не возвращает. Кидаем HEAD, и если приходит код 200, можно спокойно отправить GET, и он вернет данные.  
Зачем? - HEAD легче и быстрее + HEAD не требует авторизации (потому что не возвращает никаких данных, а просто проверяет, что на сервер можно обращаться).
## Options
OPTIONS - отвечает за получение данных о том, каким образом можно коммуницировать с сервером. В ответе сервера получаем методы => сервер принимает только "эти" методы и никакие другие.
## Get
https://habr.com/ru/companies/X5Tech/articles/798681/
- *Тип метода* – тут понятно: GET. Он используется для получения данных с сервера без их изменения.
- *Endpoint* – это указание на конкретный ресурс, к которому мы хотим получить доступ. Например, если мы хотим получить информацию о пользователях, то endpoint может быть `/users`.
- *Query параметры* – это параметры, которые мы можем передавать в URL строке после знака “`?`”. Например, если мы хотим получить список пользователей, отсортированных по имени и возрасту, то URL может выглядеть так: `/users?sort=name&age=30`. Query параметры позволяют нам фильтровать, сортировать, форматировать данные, которые мы получаем (в основном).
- *Логика обработки* – это описание того, как метод будет работать и какие данные он будет получать. Это не является частью самого интерфейса, но важно при проектировании API. Например, мы можем определить, что метод GET на ресурсе `/users` будет возвращать список пользователей из таблицы users в формате JSON с какими-либо трансформациями.
- *Ответ* – это сам контент в определённом формате, который отдаёт сервер. В данном случае мы будем оперировать форматом JSON, который является одним из самых популярных форматов для обмена данными в веб-приложениях.
## Post
Предназначен для отправки данных на сервер. Тип тела запроса указывается в заголовке.
Разница между [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT) и `POST` состоит в том, что `PUT` является идемпотентным: повторное его применение даёт тот же результат, что и при первом применении (то есть у метода нет _побочных эффектов_), тогда как повторный вызов одного и того же метода `POST` может иметь такие эффекты, как например, оформление одного и того же заказа несколько раз.
## Put

Разница между `PUT` и [`POST`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/POST) в том, что `PUT` является идемпотентным, т.е. единичный и множественные вызовы этого метода, с идентичным набором данных, будут иметь тот же результат выполнения (без сторонних эффектов), в случае с `POST`, множественный вызов с идентичным набором данных может повлечь за собой сторонние эффекты.

Put создаёт новый ресурс или заменяет представление целевого ресурса (обновляет ресурс) данными, представленными в теле запроса.
Грубо говоря не создает новую сущность, а обновляет существующую.
## Delete
 удаляет данные/какую-либо сущность с сервера. В адресе он знает, кого именно удаляет (например, по id).
## Patch
Частично обновляет атрибуты (мы сами выбираем атрибуты) конкретного объекта. В отличии от Put который полностью перезаписывает.

**Метод запроса HTTP `PATCH`** частично изменяет ресурс.
В какой-то степени `PATCH` можно назвать аналогом действия «обновить» из [CRUD](https://developer.mozilla.org/en-US/docs/Glossary/CRUD) (однако не следует путать HTTP и [CRUD](https://developer.mozilla.org/en-US/docs/Glossary/CRUD) — это две разные вещи).
Запрос `PATCH` является набором инструкций о том, как изменить ресурс. В отличие от [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT), который полностью заменяет ресурс.
`PATCH` может как быть идемпотентным, так и не быть, в отличие от [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT), который всегда идемпотентен. Операция считается идемпотентной, если её многократное выполнение приводит к тому же результату, что и однократное. Например, если автоинкрементное поле является важной частью ресурса, то [`PUT`](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods/PUT) перезапишет его (т.к. он перезаписывает всё), но `PATCH` может и не перезаписать.
## Connect
CONNECT - нужен, чтобы открыть каналы связи (например, SSL). Под капотом сейчас любой браузер делает это самостоятельно.
## Trace
TRACE - цепочка запросов. С помощью TRACE восстанавливается цепочка в обратном порядке и приходит в виде ответа. По данным из ответа можно понять, что происходило "до" этого.